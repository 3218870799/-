目前正在做的一个产品，面向的是公司，不同公司提供的需求不一样，每个公司下的用户操作权限不同，客户权限不同；

主要逻辑是：

公司选择菜单，角色配置菜单权限，用户选择角色拥有菜单权限；

菜单要可以控制页面，按钮，字段；有些再添加一些可动态修改的参数，分为系统参数，公司参数以及客户参数，便于管理；典型的RBAC管理；

方案：

运维端：

用户端：

运维端控制维护不同公司可以采用不同的菜单（普通版菜单，卓越版菜单，豪华版全菜单），每个公司下不同用户分配不同的角色，公司运维账号即可给该公司不同角色赋予不同的权限，然后给用户赋予角色；

这样就可以针对众多的公司用户不同的需求进行区分；

基本功能，有些公司想用一些标准的一些流程等；用客户磨炼标准的流程；这种情况可能必须将自己的数据暴露给提供商；

多租户：

甲方要求保存在自己的数据库，不能保存在我们的库里；

每个小区定制化开发，部分表可能都不一样；

动态添加租户和租户数据库；不down机动态添加数据库；

注意点：

隔离性，不能访问到别的小区的数据；或则公司直接保存在不同的表中；

方案三：连接多个数据库，库里的数据可能不一样；为不同租户提供独立的数据库，有助于简化数据模型的扩展设计；增加了数据库的成本；

多租户+分布式会有什么问题？

InnoDB的自增值问题，雪花算法；

多数据库的事务问题；XA两段式提交；



多租户的方案：

方案一：每个租户一套数据库，数据隔离级别最高，安全性最好，但是维护成本也是最高的，一段需要升级，所有的库都要升级；

方案二：共享数据库，一个数据库，每个租户一个Schema（不同数据库可能设置的不同，可以理解为用户）一般都使用中间件如Mycat进行分区；

方案三：共享数据库，共享数据架构；成本比较低；安全性要求性越高，越需要隔离；

存储的数据量越大，越趋向于隔离，小公司的错误不能影响大公司的使用；



问题：维护在客户本地的一些配置，有的客户运维要一些表的说明维护，但是我们不能给，防止他们直接添加菜单给他们自己添加一些其他的功能；









