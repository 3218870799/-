认证流程：

1：用户通过前端系统发送登录请求，请求中携带账号，密码，验证码等信息；

2：前端登录请求首先请求到网关服务，网关服务将请求路由到权限微服务；

3：权限微服务进行认证操作，如果认证通过则 生成jwt token  返回给前端，同时将用户用户拥有的资源权限使用userId 作为key保存到缓存中；

鉴权流程：

1：用户认证后访问其他功能时将jwt token 放在请求头中，首先经过网关服务处理；

2：在网关服务的过滤器中获取请求头中的token并进行解析，将解析出的用户相关数据放在zuul的header中；

3：在网关服务的过滤器中进行鉴权相关处理；





权限方案：

传统的RBAC权限设计

用户—角色——权限；

如果用户和权限直接关联，当批量赋权或者回收权限时只能一个个的去操作；

用户和角色的关系是多对多的；

用户组：对于用户组来说，是把众多的用户划分为一组，进行批量授予角色，即，批量授予权限。举个栗子，对于部门来说，一个部门拥有一万多个员工，这些员工都拥有相同的角色，如果没有用户组，可能需要一个个的授予相关的角色，在拥有了用户组以后，只需要，把这些用户全部划分为一组，然后对该组设置授予角色，就等同于对这些用户授予角色。

数据模型：

```txt
组织表;公司表;租户表;
岗位表;
用户表;
角色表;

资源表：
菜单表；

用户角色关系表；
角色权限关系表；
角色组织关系表；
```

菜单和资源其实都属于权限，也有设计成一张表的；

菜单权限：对应系统的菜单，不同用户拥有不同的菜单权限；

资源权限：对应某个功能的访问接口，拥有权限这可以访问此接口

